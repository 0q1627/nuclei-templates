id: missing-dmarc

info:
  name: Missing DMARC Record
  author: brenocss
  severity: info
  tags: dns,dmarc

dns:
  - name: _dmarc.{{FQDN}}
    type: TXT
    class: inet
    recursion: true
    retries: 3
      
    matchers:
      - type: dsl
        dsl:
          - "!contains(tolower(answer), 'v=dmarc1')"
          - "rcode == 0"
        condition: and