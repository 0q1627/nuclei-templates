id: dmarc-spoof

info:
  name: DMARC Spoof
  author: brenocss
  severity: info
  tags: dns,dmarc
  reference: https://support.google.com/a/answer/2466580?hl=en

dns:
  - name: _dmarc.{{FQDN}}
    type: TXT
    class: inet
    recursion: true
    retries: 3

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "contains(tolower(answer), 'v=dmarc1')"
          - "contains(tolower(answer), 'p=none')"
          - "rcode == 0"
        condition: and